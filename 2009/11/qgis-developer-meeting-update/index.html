<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>QGIS developer meeting update</title>
    <link rel="stylesheet" href="../../../theme/css/main.css">
    <!-- <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"> -->
    <link href="http://www.carsonfarmer.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Carson Farmer Atom Feed" />
    <link href="http://www.carsonfarmer.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="Carson Farmer RSS Feed" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.js"></script>
    <script src="../../../libs/bootstrap/js/bootstrap.min.js"></script>
    
    <!-- <script type="text/javascript" src="http://leaflet.cloudmade.com/dist/leaflet.js"></script> -->
    <!-- <link rel="stylesheet" href="http://leaflet.cloudmade.com/dist/leaflet.css" /> -->
    <!--[if lte IE 8]><link rel="stylesheet" href="http://leaflet.cloudmade.com/dist/leaflet.ie.css" /><![endif]-->
    <!-- <script type="text/javascript" src="http://maps.stamen.com/js/tile.stamen.js?v1.2.3"></script> -->
    <!--<script src="http://twitter.github.io/bootstrap/assets/js/bootstrap-tooltip.js"></script> -->
    <!--[if IE]>
        <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head> 

<body id="index" class="home">
<img id="bg" src="../../../theme/images/bg/bg-1024.png" style="position: fixed; top: 0; left: 0;">
        <header id="banner" class="body">
                <!-- <h1><a href="../../../">Carson Farmer  <strong>www.carsonfarmer.com</strong></a></h1> -->
                <div class="navbar navbar-fixed-top sticky" role='navigation'>
                    <div class="navbar-inner">
                        <ul class="nav">
                            <form class="navbar-search pull-right">
                            <div class='input-append'>
                            <input type="text" class="search-query" id="top-query" placeholder="Search...">
                            <div class="dropdown pull-right" id="top-dropdown">
                            <a class="dropdown-toggle" id="top-toggle" role="button" data-toggle="dropdown" data-target="#" href="."></a>
                            <ul class="dropdown-menu pull-right" role="menu" id="top-results" aria-labelledby="top-toggle"></ul></div>
                            </div>
                            </form>
<li><a class="brand" id="home" href="../../../">
                                    <img src="../../../theme/images/title.svg" id="title" class="svg"></img>
                                </a></li>
                                    <li><a href="../../../about/"><i class="fa fa-info-circle"></i> About</a></li>
                                    <li><a href="../../../curriculum-vitae/"><i class="fa fa-rocket"></i> Curriculum&nbsp;Vitae</a></li>
                                    <li><a href="../../../research/"><i class="fa fa-globe"></i> Research</a></li>
                            <li class="dropdown">
                                <a class="dropdown-toggle" data-toggle="dropdown" role="button" id="social-drop" href="#">
                                <i class="fa fa-group"></i> Social<span class="caret"></span></a>
                                <ul class="dropdown-menu pull-right" role="menu" id="social-menu" aria-labelledby="social-drop">
                                    <li>
                                      <a href="http://www.carsonfarmer.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">
                                      <i class="fa fa-rss"></i> atom feed</a>
                                    </li>
                                    <li>
                                      <a href="http://www.carsonfarmer.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate">
                                      <i class="fa fa-rss"></i> rss feed</a>
                                    </li>
                                        <li><a href="https://twitter.com/CarsonFarmer"><i class="fa fa-twitter"></i> twitter</a></li>
                                        <li><a href="https://github.com/cfarmer"><i class="fa fa-github"></i> github</a></li>
                                        <li><a href="http://about.me/carson.farmer"><i class="fa fa-user"></i> about.me</a></li>
                                        <li><a href="http://hunter-cuny.academia.edu/CarsonFarmer"><i class="fa fa-book"></i> academia.edu</a></li>
                                        <li><a href="http://www.linkedin.com/pub/carson-farmer/40/3bb/27/"><i class="fa fa-linkedin"></i> linkedin</a></li>
                                        <li><a href="https://plus.google.com/108062014159451325697/about/p/pub"><i class="fa fa-google-plus"></i> google+</a></li>
                                        <li><a href="http://cuny.is/cfarmer"><i class="fa fa-comment-o"></i> cuny.is</a></li>
                                        <li><a href="mailto:carson.farmer@gmail.com"><i class="fa fa-envelope"></i> email</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article class="hentry shadow">
    <header>
      <h1 class="entry-title">
        <a href="../../../2009/11/qgis-developer-meeting-update/" rel="bookmark"
           title="Permalink to QGIS developer meeting update"><span class="caps">QGIS</span> developer meeting&nbsp;update</a></h1>
      <abbr class="published" title="2009-11-11T17:33:00">
          <i class="icon-calendar"></i>
          Wed 11 November 2009
      </abbr>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="CarsonFarmer">Tweet</a>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
<div class="g-plusone" data-size="medium"></div>
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>
<script src="//platform.linkedin.com/in.js" type="text/javascript">
 lang: en_US
</script>
<script type="IN/Share" data-counter="right"></script>    </header>

    <div class="entry-content">
      <p>Last week I attended the 2009 <span class="caps">QGIS</span> Developers Meeting in Vienna,
Austria. We all had a really good time, <a href="http://blog.qgis.org/node/139">met many new people</a>, and
actually got a lot done in the process. There have been updates about
the meeting <a href="http://qgis.org/en/developer-meeting.html">(hackfest)</a> on the <span class="caps">QGIS</span> blog, and Tim Sutton has <a href="http://linfiniti.com/2009/11/report-back-on-the-qgis-hackfest-in-vienna-november-2009/">written
a few words</a> about our progress as well. I&#8217;m not going to repeat what
others have said, but I <em>would</em> like to give a quick update on the work
that I was doing at the meeting, and show off the new geoprocessing
features now available to all <span class="caps">QGIS</span> developers (Python and C++).
</p>
<p>My main goal for the meeting was to start/continue work on the new
&#8216;Analysis Library&#8217; for <span class="caps">QGIS</span>. Basically, this was intended to be a port
(to C++ from Python) of the <a href="http://www.ftools.ca/">fTools</a> suite of tools already available
in <span class="caps">QGIS</span>. These tools currently provide geoprocessing, geometry, and
various other analysis functionality natively within <span class="caps">QGIS</span>. However, the
Python implementation is simply a Python plugin, and so does not provide
these functions to other developers hoping use/add geoprocessing
capabilities to their own plugins or tools. In addition, in some cases
the Python fTools functions can be quite slow, and would benefit greatly
from the speed-ups afforded by a compiled language like&nbsp;C++.</p>
<p>Porting these functions to C++ is still underway, and so far we have
implementations for buffering, dissolving, centroids, convex hulls,
layer extents in the QgsGeometryAnalyzer class, and intersections in the
QgsOverlayAnalyzer class. We have set it up so that it should be
relatively easy to add functions and classes to the library in the
future, though I expect there will be many changes to the library along
the way. We have also created Python bindings for the library, so these
functions will also be available to Python developers. By doing so, it
is now extremely easy to perform geoprocessing functions directly from
the <span class="caps">QGIS</span> Python console, or from <span class="caps">QGIS</span> Python plugins, with only a few
lines of&nbsp;code.</p>
<h3>The old&nbsp;way</h3>
<p>In the past, Python developers had to operate directly on the
geometries of the layers in order to do any sort of geoprocessing. For
example, to perform a (very) simple buffer, one had to use the following
code in the <span class="caps">QGIS</span> Python&nbsp;console:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">iface</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">iface</span><span class="o">.</span><span class="n">mapCanvas</span><span class="p">()</span> <span class="c"># get a reference to the map canvas</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># get a reference to the first layer in the layer list</span>
<span class="n">provider</span> <span class="o">=</span> <span class="n">layer</span><span class="o">.</span><span class="n">dataProvider</span><span class="p">()</span> <span class="c"># data provider for the layer</span>
<span class="n">provider</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">layer</span><span class="o">.</span><span class="n">pendingAllAttributesList</span><span class="p">(),</span> <span class="n">QgsRectangle</span><span class="p">(),</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span> <span class="c"># select features to buffer</span>
<span class="n">in_feat</span> <span class="o">=</span> <span class="n">QgsFeature</span><span class="p">()</span> <span class="c"># empty input feature</span>
<span class="n">out_feat</span> <span class="o">=</span> <span class="n">QgsFeature</span><span class="p">()</span> <span class="c"># empty output feature</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">QgsVectorFileWriter</span><span class="p">(</span> <span class="s">&quot;output_path.shp&quot;</span><span class="p">,</span> <span class="n">provider</span><span class="o">.</span><span class="n">encoding</span><span class="p">(),</span> <span class="n">provider</span><span class="o">.</span><span class="n">fields</span><span class="p">(),</span> 
<span class="n">QGis</span><span class="o">.</span><span class="n">WKBPolygon</span><span class="p">,</span> <span class="n">provider</span><span class="o">.</span><span class="n">crs</span><span class="p">()</span> <span class="p">)</span> <span class="c"># use this to write results to disk (as shapefile)</span>
<span class="k">while</span><span class="p">(</span><span class="n">provider</span><span class="o">.</span><span class="n">nextFeature</span><span class="p">(</span><span class="n">feat</span><span class="p">)):</span> <span class="c"># for each feature that we selected...</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="n">feat</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span> <span class="c"># grab it&#39;s geometry</span>
    <span class="nb">buffer</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="c"># buffer the geometry</span>
    <span class="n">out_feat</span><span class="o">.</span><span class="n">setAttributeMap</span><span class="p">(</span><span class="n">in_feat</span><span class="o">.</span><span class="n">attributeMap</span><span class="p">())</span> <span class="c"># set the attributes for the output feature</span>
    <span class="n">out_feat</span><span class="o">.</span><span class="n">setGeometry</span><span class="p">(</span><span class="nb">buffer</span><span class="p">)</span> <span class="c"># set the bufer as the output geometry</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">addFeature</span><span class="p">(</span><span class="n">out_feat</span><span class="p">)</span> <span class="c"># write the feature to file</span>
<span class="k">del</span> <span class="n">writer</span> <span class="c"># delete/close the writer to save to disk</span>
</pre></div>


<h3>The new&nbsp;way</h3>
<p>With the new <span class="caps">QGIS</span> Analysis Library, things are much simpler, and the
same (or more complex) buffering example can be completed with only 5
lines of code in the <span class="caps">QGIS</span> Python&nbsp;Console:</p>
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">qgis.core</span> <span class="kn">import</span> <span class="n">iface</span> <span class="c"># import iface (interface)</span>
<span class="kn">from</span> <span class="nn">qgis.analysis</span> <span class="kn">import</span> <span class="n">QgsGeometryAnalyzer</span> <span class="c"># import (par of) the analysis library</span>
<span class="n">mc</span> <span class="o">=</span> <span class="n">iface</span><span class="o">.</span><span class="n">mapCanvas</span><span class="p">()</span> <span class="c"># get a reference to the map canvas</span>
<span class="n">layer</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">layer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c"># get a reference to the first layer in the layer list</span>
<span class="n">QgsGeometryAnalyzer</span><span class="p">()</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">layer</span><span class="p">,</span> <span class="s">&quot;output_path.shp&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c"># perform the buffer</span>
</pre></div>


<p>Note: only the first two parameters in the buffer function are really
required, and the additional parameters control the buffer distance,
whether to use a subset (selected features) of the layer, whether to
dissolve the output buffer regions, and whether to use a field (field
<span class="caps">ID</span>) from the input layer&#8217;s attribute table as the buffer&nbsp;distance.</p>
<p>Pretty nice eh? For now, the <span class="caps">QGIS</span> Analysis Library is only available in
Trunk, however, before long these tools should be available as part of
the official releases, so I hope we will start to see more Plugins
taking advantage of these new capabilities in the&nbsp;future&#8230;</p>
    <p class="category">
        <i class="icon-certificate"></i>
        <a href="../../../category/announcement.html">Announcement</a> 
    </p>
    <p class="tag">
        <i class="icon-tags"></i>
 <a href="../../../tag/c.html">C++</a>
 <a href="../../../tag/geoprocessing.html">geoprocessing</a>
 <a href="../../../tag/python.html">Python</a>
 <a href="../../../tag/qgis.html">QGIS</a>
 <a href="../../../tag/free-open-source-software-foss.html">Free open-source software (FOSS)</a>
 <a href="../../../tag/geographic-information-sciencesystems-gis.html">Geographic information science/systems (GIS)</a>
 <a href="../../../tag/helpful-tips.html">Helpful tips</a>
 <a href="../../../tag/how-to.html">How to</a>
    </p>
    </div><!-- /.entry-content -->
      <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
          var disqus_identifier = "2009/11/qgis-developer-meeting-update/";
          var disqus_url = "../../../2009/11/qgis-developer-meeting-update/";
          (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://carsonfarmer.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
      </div>

  </article>
</section>
        <section id="extras" class="body shadow">
<div class="twitter">
    <h2><i class="icon-twitter"></i> twitter</h2>
    <a class="twitter-timeline" href="https://twitter.com/CarsonFarmer" 

        data-chrome="nofooter noheader noborders transparent" 
        data-widget-id="330339195518337025"
        height="300" lang="EN"
        data-related="CarsonFarmer">
        Tweets by @CarsonFarmer
    </a>
    <script>
        !function(d,s,id){
            var js,fjs=d.getElementsByTagName(s)[0], p=/^http:/.test(d.location)?'http':'https';
            if(!d.getElementById(id)){
                js=d.createElement(s);
                js.id=id;js.src=p+"://platform.twitter.com/widgets.js";
                fjs.parentNode.insertBefore(js,fjs);
            }
        }(document,"script","twitter-wjs");
    </script>
</div>
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body ">
            <address id="about" class="vcard body shadow">
                <ul id="links">
                    <li><a href="../../../contact/">Contact me</a></li>
                    <li><a href="http://www.carsilab.org/">CARSI Lab</a></li>
                </ul>
                Carson Farmer | Assistant Professor of GIScience | Department Geography</br>
                Hunter College, CUNY | 695 Park Avenue, New York, NY, 10065</br>
            </address><!-- /#about -->
            <p style="text-align: center; color: #fff;">This blog is proudly 
                powered by <a href="http://getpelican.com/">Pelican</a>, 
                which takes great advantage of 
                <a href="http://python.org">Python</a>.</br>
                Icons are courtesy of 
                <a href="http://fortawesome.github.io/Font-Awesome/">FontAwesome</a> 
                and the styling is mostly done via 
                <a href="http://getbootstrap.com/">Bootstrap</a>.</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41110370-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
    var disqus_shortname = 'carsonfarmer';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script src="../../../theme/js/tools.js"></script>
</body>
</html>